{"version":3,"sources":["components/HeroSection.js","components/Footer.js","pages/Home.js","components/useAuth.js","components/TrackSearchResult.js","components/Player.js","pages/Dashboard.js","components/NavBar.js","components/App.js","index.js"],"names":["HeroSection","className","to","Footer","Home","useStickyState","defaultValue","key","useState","stickyValue","window","localStorage","getItem","JSON","parse","value","setValue","useEffect","setItem","stringify","TrackSearchResult","track","chooseTrack","style","cursor","onClick","src","albumUrl","height","width","title","artist","Player","accessToken","trackUri","play","setPlay","token","showSaveIcon","initialVolume","callback","state","isPlaying","uris","spotifyApi","SpotifyWebApi","clientId","Dashboard","code","console","log","setAccessToken","refreshToken","setRefreshToken","expiresIn","setExpiresIn","axios","post","then","res","data","history","pushState","catch","interval","setInterval","clearInterval","useAuth","search","setSearch","searchResults","setSearchResults","playingTrack","setPlayingTrack","lyrics","setLyrics","get","params","cancel","searchTracks","body","tracks","items","map","smallestAlbumImage","album","images","reduce","smallest","image","heigh","artists","name","uri","url","Container","Form","Control","type","placeholder","onChange","e","target","overflowY","length","whiteSpace","NavBar","URLSearchParams","location","App","path","exact","component","render","ReactDOM","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.1573d50a.chunk.js","sourcesContent":["import React from 'react'\nimport '../css/HeroSection.css'\nimport { Link } from 'react-router-dom'\nexport default function HeroSection() {\n    return (\n        <div className='main-container'>\n            <Link to='/spotify' className='btn-hero'>Login with Spotify</Link>\n        </div>\n    )\n}\n\n","import React from 'react'\nimport '../css/Footer.css'\n \n\nexport default function Footer() {\n    return (\n        <div className='footer-container'>\n            \n        </div>\n    )\n}\n","import React from 'react'\nimport HeroSection from '../components/HeroSection'\nimport Footer from '../components/Footer'\nimport '../css/Home.css'\nexport default function Home() {\n    return (\n        <>\n            <HeroSection />\n        </>\n    )\n}\n\n\n","import {useState, useEffect} from 'react'\nimport axios from 'axios'\n\nfunction useStickyState(defaultValue, key) {\n    const [value, setValue] = useState(() => {\n      const stickyValue = window.localStorage.getItem(key);\n      return stickyValue !== null\n        ? JSON.parse(stickyValue)\n        : defaultValue;\n    });\n\nuseEffect(() => {\n    window.localStorage.setItem(key, JSON.stringify(value));\n  }, [key, value]);\n  return [value, setValue];\n}\n\nexport default function useAuth(code) {\n    const [accessToken, setAccessToken] = useStickyState(\"\", \"accessToken\");\n    const [refreshToken, setRefreshToken] = useStickyState(\"\", \"refreshToken\");\n    const [expiresIn, setExpiresIn] = useStickyState(\"\", \"expiresIn\");\n\n    useEffect(() => {\n        if(!code) return\n        console.log(\"attempting to login\")\n        axios.post('http://localhost:3001/login' ,{\n            code,\n        })\n        .then(res => {\n            setAccessToken(res.data.accessToken)\n            setRefreshToken(res.data.refreshToken)\n            setExpiresIn(res.data.expiresIn)\n        \n            console.log(\"redirecting to dashboard\")\n            window.history.pushState({}, null, \"/dashboard\")\n        })\n        .catch(() => {\n                // window.location ='/'\n        })\n    }, [code])\n\n    useEffect(() => {\n        console.log(\"checking refresh\")\n        console.log(refreshToken)\n        console.log(expiresIn)\n        if(!refreshToken || !expiresIn) return\n        console.log(\"refrshing token\")\n        const interval = setInterval(() => {\n\n        axios.post('http://localhost:3001/refresh' ,{\n            refreshToken,\n        })\n        .then(res => {\n            setAccessToken(res.data.accessToken)\n            setExpiresIn(res.data.expiresIn)\n        })\n        .catch(() => {\n                // window.location ='/'\n        })\n    }, (expiresIn - 60) * 1000)\n\n    return () => clearInterval(interval);\n    }, [refreshToken, expiresIn])\n\n    return accessToken;\n}\n","import React from 'react'\n\nexport default function TrackSearchResult({track, chooseTrack}) {\n    function handlePlay() {\n        chooseTrack(track)\n    }\n    \n    return (\n        <div className=\"d-flex m-2 align-items-center\" \n            style={{cursor: 'pointer'}}\n            onClick={handlePlay}\n            >\n            <img src={track.albumUrl} style={{height:'64px', width:'64px'}} />\n            <div className=\"ml-3\">\n                <div>{track.title}</div>\n                <div className=\"text-muted\">{track.artist}</div>\n            </div>\n        </div>\n    )\n}\n","import React from 'react'\nimport SpotifyPlayer from 'react-spotify-web-playback'\nimport {useEffect, useState} from 'react'\n\n\nexport default function Player({accessToken, trackUri}) {\n    const [play, setPlay] = useState(false)\n\n    useEffect(() => setPlay(true), [trackUri])\n\n    if(!accessToken) return null\n    return (\n        <SpotifyPlayer\n        token={accessToken}\n        showSaveIcon\n        initialVolume={.3}\n        callback={state => {\n            if(!state.isPlaying) setPlay(false)\n        }}\n        play={play}\n        uris={ trackUri ? [trackUri] : []}\n        />\n    )\n}\n","import React from 'react'\nimport useAuth from '../components/useAuth'\nimport { Container, Form } from 'react-bootstrap'\nimport { useState, useEffect } from 'react'\nimport SpotifyWebApi from 'spotify-web-api-node'\nimport TrackSearchResult from '../components/TrackSearchResult'\nimport Player from '../components/Player'\nimport axios from 'axios'\n\nconst spotifyApi = new SpotifyWebApi({\n    clientId: 'f38e45905b8f40f4a2400c457ec4af11'\n})\n\nexport default function Dashboard({ code }) {\n    console.log(\"made it to the dashboard\")\n    \n    const accessToken = useAuth(code)\n    const [search, setSearch] = useState(\"\")\n    const [searchResults, setSearchResults] = useState([])\n    const [playingTrack, setPlayingTrack] = useState([])\n    const [lyrics, setLyrics] = useState(\"\")\n\n    function chooseTrack(track) {\n        setPlayingTrack(track)\n        setSearch('')\n        setLyrics(\"\")\n    }\n\n    useEffect(() => {\n        if (!playingTrack) return\n\n        axios.get('http://localhost:3001/lyrics', {\n            params: {\n                track: playingTrack.title,\n                artist: playingTrack.artist\n            }\n        }).then(res => {\n            setLyrics(res.data.lyrics)\n        })\n\n    }, [playingTrack])\n\n    useEffect(() => {\n        if (!accessToken) return null\n        spotifyApi.setAccessToken(accessToken);\n    }, [accessToken])\n\n    useEffect(() => {\n        if (!search) return setSearchResults([])\n        if (!accessToken) return\n\n        let cancel = false\n        spotifyApi.searchTracks(search).then(res => {\n            if (cancel) return\n            setSearchResults(res.body.tracks.items.map(track => {\n                const smallestAlbumImage = track.album.images.reduce((smallest, image) => {\n                    if (image.heigh < smallest.height) return image\n                    return smallest\n                }, track.album.images[0])\n                return {\n                    artist: track.artists[0].name,\n                    title: track.name,\n                    uri: track.uri,\n                    albumUrl: smallestAlbumImage.url\n                }\n            }))\n        })\n        return () => cancel = true;\n    }, [search, accessToken])\n\n    return (\n        <Container className=\"d-flex flex-column py-2\" style={{ height: \"90vh\" }}>\n            <Form.Control\n                type=\"search\"\n                placeholder=\"Search Songs/Artists\"\n                value={search}\n                onChange={e => setSearch(e.target.value)} />\n            <div className=\"flex-grow-1 my-2\" style={{ overflowY: 'auto' }}>\n                {searchResults.map(track => (\n                    <TrackSearchResult track={track} key={track.uri} chooseTrack={chooseTrack} />\n                ))}\n                {searchResults.length === 0 && (\n                    <div className=\"text-center\" style={{ whiteSpace: 'pre' }}>\n                        {lyrics}\n                    </div>\n                )}\n            </div>\n            <div><Player accessToken={accessToken} trackUri={playingTrack?.uri} /></div>\n        </Container>\n\n\n    )\n}\n","import React from 'react'\nimport { Link } from 'react-router-dom'\nimport '../css/NavBar.css'\n\nexport default function NavBar() {\n    return (\n        <div className=\"navbar\">\n            <div className=\"navbar-container\">\n                <ul className=\"nav-menu\">\n                    <li className=\"nav-item\">\n                        <Link to=\"/\" className=\"nav-links\">Home</Link>\n                    </li>\n                    <li className=\"nav-item\">\n                        <Link to=\"/\" className=\"nav-links\">About</Link>\n                    </li>\n                    <li className=\"nav-item\">\n                        <Link to=\"/spotify\" className=\"nav-links\">Login</Link>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    )\n}\n","import React from 'react';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport Home from '../pages/Home'\nimport Dashboard from '../pages/Dashboard'\nimport Navbar from './NavBar'\nimport Footer from './Footer'\nimport { BrowserRouter as Router, Switch, Route } from \"react-router-dom\";\nimport '../css/App.css'\n\n\nconst AUTH_URL = 'https://accounts.spotify.com/authorize?' +\n  'client_id=f38e45905b8f40f4a2400c457ec4af11&' +\n  'response_type=code&' +\n  'scope=streaming%20user-read-email%20user-read-private%20user-read-playback-state%20user-modify-playback-state%20user-library-read%20user-library-modify&' +\n  'redirect_uri=http://localhost:3000/dashboard'\n\nconst code = new URLSearchParams(window.location.search).get('code');\n\nfunction App() {\n  return (\n    <div className=\"main\">\n      <Router>\n        <Navbar />\n        <Switch>\n          <Route path='/' exact component={Home} />\n          <Route\n            path=\"/dashboard\"\n            render={() => <Dashboard code={code} />}\n          />\n          <Route path='/spotify' component={() => {\n            window.location = AUTH_URL;\n            return null;\n          }} />\n        </Switch>\n        <Footer />\n      </Router>\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './components/App';\n\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}